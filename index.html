<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2/20 é«˜é›„æªåœ˜ç¥å™¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <style>
        :root { 
            --primary: #007bff; 
            --selected: #2c3e50; /* é¸ä¸­å¾Œçš„æ·±è‰² */
            --rush-bg: #ffebee; --rush-border: #ef5350; /* ç‰¹ç¨®å…µç´… */
            --chill-bg: #e8f5e9; --chill-border: #66bb6a; /* é¤Šç”Ÿåœ˜ç¶  */
            --food-bg: #fff3e0; --food-border: #ffa726; /* ç¾é£Ÿé»ƒ */
            --trans-bg: #e3f2fd; --trans-border: #2196f3; /* äº¤é€šè— */
        }
        
        body { font-family: "å¾®è»Ÿæ­£é»‘é«”", sans-serif; background: #f4f7f6; margin: 0; padding: 0; padding-bottom: 100px; color: #333; }
        
        /* å°è¦½åˆ— */
        .nav { background: #333; padding: 15px; color: white; text-align: center; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .nav h1 { margin: 0; font-size: 1.2rem; letter-spacing: 1px; }

        /* å®¹å™¨è¨­å®š */
        .container { max-width: 800px; margin: 0 auto; padding: 15px; }

        /* å¡ç‰‡é€šç”¨æ¨£å¼ */
        .card { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        h2 { margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px; font-size: 1.1rem; color: #444; }
        p { margin: 10px 0; color: #666; font-size: 0.95rem; }

        /* 1. æš±ç¨±èˆ‡å•å· */
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; font-weight: bold; margin-bottom: 5px; color: #333; }
        .input-group input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-size: 1rem; box-sizing: border-box; background: #fafafa; }
        
        .q-group { margin-bottom: 15px; }
        .btn-opt { 
            width: 100%; padding: 15px; margin: 6px 0; 
            border: 1px solid #ddd; border-radius: 8px; 
            background: white; text-align: left; 
            transition: all 0.2s; cursor: pointer; 
            font-size: 0.95rem; display: flex; align-items: center; justify-content: space-between;
        }
        .btn-opt:hover { background: #f5f5f5; }
        
        /* é¸ä¸­ç‹€æ…‹æ¨£å¼ */
        .btn-opt.active { 
            background: var(--selected); color: white; 
            border-color: var(--selected); font-weight: bold; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.2); transform: scale(1.01);
        }
        .btn-opt.active::after { content: 'âœ”'; font-size: 1.2rem; }

        /* æ¸¬é©—çµæœæ¨™ç±¤ */
        #result-badge { 
            margin-top: 15px; padding: 10px; background: #ffe0b2; 
            border-radius: 6px; color: #e65100; font-weight: bold; text-align: center; display: none; 
        }

        /* 2. åœ°åœ– */
        .map-frame { width: 100%; height: 450px; border: none; border-radius: 8px; background: #eee; }

        /* 3. è¡Œç¨‹æ‹–æ‹‰å€ */
        .pool { 
            border: 2px dashed #bbb; min-height: 120px; 
            display: flex; flex-wrap: wrap; gap: 8px; align-content: flex-start;
            padding: 10px; background: #fafafa; border-radius: 8px; 
        }
        
        /* æ‹–æ›³ç‰©ä»¶æ¨£å¼ */
        .item { 
            padding: 8px 12px; border-radius: 6px; font-size: 0.85rem; 
            cursor: grab; display: inline-block; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); user-select: none; 
            background: white; border: 1px solid #eee; position: relative;
        }
        .item small { display: block; font-size: 0.75em; opacity: 0.8; margin-top: 2px; }
        
        /* åˆ†é¡é¡è‰² */
        .item.rush { background: var(--rush-bg); border-left: 5px solid var(--rush-border); }
        .item.chill { background: var(--chill-bg); border-left: 5px solid var(--chill-border); }
        .item.food { background: var(--food-bg); border-left: 5px solid var(--food-border); }
        .item.trans { background: var(--trans-bg); border-left: 5px solid var(--trans-border); color: #000; font-weight: bold; }

        /* æ™‚é–“è»¸æ’æ§½ */
        .time-slot { display: flex; margin-bottom: 10px; background: white; border-radius: 8px; border: 1px solid #e0e0e0; overflow: hidden; min-height: 70px; }
        .time-label { 
            padding: 5px; background: #e3f2fd; color: #1565c0; 
            font-weight: bold; font-size: 0.85rem; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            width: 75px; flex-shrink: 0; text-align: center; border-right: 1px solid #ddd;
        }
        .slot-area { flex-grow: 1; padding: 8px; display: flex; flex-wrap: wrap; gap: 5px; align-items: center; }
        
        /* æ‹–æ›³æ™‚çš„æ®˜å½± */
        .ghost { opacity: 0.4; background: #ccc; }

        /* åº•éƒ¨å›ºå®šæŒ‰éˆ•åˆ— */
        .action-bar { 
            position: fixed; bottom: 0; left: 0; width: 100%; 
            background: white; padding: 12px; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); 
            display: flex; justify-content: center; gap: 15px; z-index: 999; 
            box-sizing: border-box;
        }
        .btn-main { 
            background: var(--primary); color: white; padding: 12px 25px; 
            border-radius: 50px; border: none; font-size: 1rem; font-weight: bold; 
            cursor: pointer; flex: 2; max-width: 300px; 
            box-shadow: 0 4px 6px rgba(0,123,255,0.3);
        }
        .btn-reset { 
            background: #90a4ae; color: white; padding: 12px 20px; 
            border-radius: 50px; border: none; font-weight: bold; cursor: pointer; flex: 1; max-width: 100px; 
        }
        .btn-main:active, .btn-reset:active { transform: scale(0.98); }

    </style>
</head>
<body>

<div class="nav">
    <h1>ğŸš„ 2/20 é«˜é›„æªåœ˜ç¥å™¨</h1>
</div>

<div class="container">

    <div class="card">
        <h2>1. ä½ çš„æš±ç¨± & å±¬æ€§</h2>
        <div class="input-group">
            <label>ä½ çš„åå­—/æš±ç¨±ï¼š</label>
            <input type="text" id="username" placeholder="ä¾‹ï¼šè±ªè±ª (è«‹å¡«å¯«ä»¥ä¾¿è¾¨è­˜)">
        </div>

        <p><strong>Q1. é€™æ¬¡å‡ºä¾†ç©çš„é«”åŠ›åˆ†é…ï¼Ÿ</strong></p>
        <div class="q-group" id="q1">
            <button class="btn-opt" onclick="selectOpt(this, 'q1', 1)">A. åªè¦è…¿æ²’æ–·ï¼Œæ™¯é»è·‘ä¸å®Œ (ç‰¹ç¨®å…µ)</button>
            <button class="btn-opt" onclick="selectOpt(this, 'q1', -1)">B. ç¡é£½å†å‡ºé–€ï¼Œä¸€å¤©å…©å€‹é» (é¤Šç”Ÿåœ˜)</button>
        </div>

        <p><strong>Q2. å–œæ­¡çš„æ™¯é»é¡å‹ï¼Ÿ</strong></p>
        <div class="q-group" id="q2">
            <button class="btn-opt" onclick="selectOpt(this, 'q2', 1)">A. æˆ¶å¤–çœ‹æµ·ã€çˆ¬å±±ã€æ›¬å¤ªé™½</button>
            <button class="btn-opt" onclick="selectOpt(this, 'q2', -1)">B. å®¤å…§å±•è¦½ã€ç™¾è²¨å…¬å¸å†·æ°£</button>
        </div>

        <div id="result-badge"></div>
    </div>

    <div class="card">
        <h2>2. åœ°åœ–åƒè€ƒ (å·²æ¨™è¨»ç¾é£Ÿ/æ™¯é»)</h2>
        <p>å¯ä»¥å…ˆåƒè€ƒåœ°åœ–ä½ç½®ï¼Œå†æ±ºå®šæ€éº¼æ’è¡Œç¨‹é †è·¯ï¼š</p>
        <iframe class="map-frame" src="https://www.google.com/maps/d/u/0/embed?mid=1ZjcKfex88IRUfytr3WUMttoVmXFv0x0&ehbc=2E312F"></iframe>
    </div>

    <div class="card">
        <h2>3. æ‹–æ‹‰æ’è¡Œç¨‹ (å¯è‡ªç”±ç§»å‹•)</h2>
        <p>è«‹å°‡ã€Œäº¤é€šã€èˆ‡ã€Œæƒ³å»çš„é»ã€æ‹–å…¥ä¸‹æ–¹æ™‚é–“è»¸ï¼š</p>
        
        <div id="pool" class="pool">
            <div class="item trans" data-name="å»ç¨‹:è‡ªå¼·3000(161)">å»:è‡ªå¼·3000<small>09:30æ–°ç‡Ÿ-10:18é«˜é›„</small></div>
            <div class="item trans" data-name="å»ç¨‹:å€å¿«1003">å»:å€å¿«1003<small>09:44æ–°ç‡Ÿ-10:48æ–°å·¦ç‡Ÿ</small></div>
            <div class="item trans" data-name="å›ç¨‹:è‡ªå¼·3000(196)">å›:è‡ªå¼·3000<small>20:28æ–°å·¦ç‡Ÿ-21:18æ–°ç‡Ÿ</small></div>
            <div class="item trans" data-name="å›ç¨‹:è‡ªå¼·156">å›:è‡ªå¼·156<small>21:18æ–°å·¦ç‡Ÿ-22:17æ–°ç‡Ÿ</small></div>
            <div class="item trans" style="background:#e0e0e0; color:#555;">æ·é‹/è¼•è»Œç§»å‹•</div>

            <div class="item rush">å£½å±±å‹•ç‰©åœ’</div>
            <div class="item rush">æ——æ´¥ç‡ˆå¡”+ç ²å°</div>
            <div class="item rush">è“®æ± æ½­ç’°æ¹–</div>
            <div class="item rush">è¥¿å­ç£çˆ¬æ¨“æ¢¯</div>
            
            <div class="item chill">è¼•è»ŒéŠå¤¢æ™‚ä»£</div>
            <div class="item chill">é§äºŒæ–‡å‰µæ•£æ­¥</div>
            <div class="item chill">å…§æƒŸè—è¡“ä¸­å¿ƒ</div>
            <div class="item chill">å¤§æ±æ¿•åœ°å…¬åœ’</div>
            <div class="item chill">è€çˆ¸æ©Ÿå ´å’–å•¡</div>
            <div class="item chill">SKM Park Outlets</div>

            <div class="item food">ä¸¹ä¸¹æ¼¢å ¡</div>
            <div class="item food">é¹½åŸ•è€åº—å°åƒ</div>
            <div class="item food">ç‘è±å¤œå¸‚</div>
            <div class="item food">å¤§åŸè€èˆ¹éºµ</div>
            <div class="item food">åƒè²¨é£Ÿå®´å®¤</div>
            <div class="item food">é™³è³£è³£é£¯ç³°</div>
            <div class="item food">å¾¡å…¸èŒ¶(ç²‰è§’)</div>
        </div>
    </div>

    <div class="card">
        <div class="time-slot">
            <div class="time-label">09:30<br>|<br>11:00</div>
            <div class="slot-area" id="t1" data-desc="é›†åˆå‡ºç™¼"></div>
        </div>
        <div class="time-slot">
            <div class="time-label">11:00<br>|<br>13:00</div>
            <div class="slot-area" id="t2" data-desc="åˆé¤/æ™¯é»"></div>
        </div>
        <div class="time-slot">
            <div class="time-label">13:00<br>|<br>15:00</div>
            <div class="slot-area" id="t3" data-desc="ä¸‹åˆæ´»å‹•"></div>
        </div>
        <div class="time-slot">
            <div class="time-label">15:00<br>|<br>17:00</div>
            <div class="slot-area" id="t4" data-desc="åˆèŒ¶/é€›è¡—"></div>
        </div>
        <div class="time-slot">
            <div class="time-label">17:00<br>|<br>19:00</div>
            <div class="slot-area" id="t5" data-desc="æ™šé¤æ™‚é–“"></div>
        </div>
        <div class="time-slot">
            <div class="time-label">19:00<br>|<br>22:00</div>
            <div class="slot-area" id="t6" data-desc="å¿«æ¨‚è³¦æ­¸"></div>
        </div>
    </div>

</div>

<div class="action-bar">
    <button class="btn-reset" onclick="if(confirm('ç¢ºå®šè¦æ¸…ç©ºé‡å¡«å—ï¼Ÿ')) location.reload()">é‡ç½®</button>
    <button class="btn-main" onclick="generateReport()">è¤‡è£½çµæœ (è²¼Line)</button>
</div>

<script>
    // --- 1. å•å·é‚è¼¯ (ç„¡å½ˆè·³è¦–çª—ç‰ˆ) ---
    let answers = { q1: 0, q2: 0 };

    function selectOpt(btn, group, val) {
        // ç§»é™¤åŒçµ„çš„ active æ¨£å¼
        let container = document.getElementById(group);
        let btns = container.getElementsByClassName('btn-opt');
        for (let b of btns) {
            b.classList.remove('active');
        }
        
        // è¨­å®šç•¶å‰æŒ‰éˆ•ç‚º active
        btn.classList.add('active');
        answers[group] = val;
        
        // è¨ˆç®—ä¸¦é¡¯ç¤ºå±¬æ€§
        updateBadge();
    }

    function updateBadge() {
        // åªæœ‰ç•¶å…©é¡Œéƒ½é¸äº†æ‰é¡¯ç¤ºçµæœ
        // ç‚ºäº†è®“ä½¿ç”¨è€…çŸ¥é“è‡ªå·±é¸äº†ä»€éº¼ï¼Œé€™è£¡æ”¹ç‚ºå³æ™‚é¡¯ç¤ºç›®å‰çš„å‚¾å‘
        let total = answers.q1 + answers.q2;
        let badge = document.getElementById('result-badge');
        let text = "";
        
        if (total > 0) {
            text = "ğŸ”¥ ç›®å‰å±¬æ€§ï¼šç²¾å¯¦ç‰¹ç¨®å…µ (é«”åŠ›å¥½)";
            badge.style.background = "#ffebee"; badge.style.color = "#d32f2f";
        } else {
            text = "ğŸŒ¿ ç›®å‰å±¬æ€§ï¼šä½›ç³»é¤Šç”Ÿåœ˜ (æ„›èˆ’æœ)";
            badge.style.background = "#e8f5e9"; badge.style.color = "#2e7d32";
        }
        
        // åªè¦æœ‰ä¸€é¡Œè¢«é¸ï¼Œå°±é¡¯ç¤ºæ¨™ç±¤
        if (document.querySelectorAll('.active').length > 0) {
            badge.style.display = 'block';
            badge.innerText = text;
        }
    }

    // --- 2. æ‹–æ‹‰åŠŸèƒ½è¨­å®š ---
    document.addEventListener('DOMContentLoaded', function () {
        const config = { 
            group: 'shared', 
            animation: 150, 
            delay: 100, // æ‰‹æ©Ÿé˜²èª¤è§¸
            delayOnTouchOnly: true, 
            ghostClass: 'ghost' 
        };

        // ç¶å®šå¾…é¸å€
        new Sortable(document.getElementById('pool'), config);

        // ç¶å®šæ‰€æœ‰æ™‚é–“è»¸
        ['t1','t2','t3','t4','t5','t6'].forEach(id => {
            new Sortable(document.getElementById(id), config);
        });
    });

    // --- 3. ç”¢ç”Ÿå ±è¡¨åŠŸèƒ½ ---
    function generateReport() {
        let name = document.getElementById('username').value.trim();
        if (!name) {
            alert("è«‹å…ˆåœ¨æœ€ä¸Šé¢å¡«å¯«æ‚¨çš„ã€Œæš±ç¨±ã€å–”ï¼");
            document.getElementById('username').focus();
            return;
        }

        let badgeText = document.getElementById('result-badge').innerText || "å°šæœªå®Œæ•´æ¸¬é©—";
        
        let report = `ã€2/20 é«˜é›„éŠæ„é¡˜è¡¨ã€‘\n`;
        report += `ğŸ‘¤ æš±ç¨±ï¼š${name}\n`;
        report += `ğŸ·ï¸ ${badgeText}\n`;
        report += `------------------\n`;
        
        let slots = document.querySelectorAll('.slot-area');
        let hasItem = false;

        slots.forEach(slot => {
            let items = slot.querySelectorAll('.item');
            if (items.length > 0) {
                hasItem = true;
                // å–å¾—æ™‚é–“æ¨™ç±¤ (ä¾‹å¦‚ 09:30-11:00)
                let timeLabel = slot.parentNode.querySelector('.time-label').innerText.replace(/\n/g, '').replace('|', '-');
                
                let activities = [];
                items.forEach(i => {
                    // å„ªå…ˆæŠ“ data-name (æ¯”è¼ƒç°¡æ½”çš„æ–‡å­—)ï¼Œæ²’æœ‰çš„è©±æŠ“ innerText ä¸¦ä¸”å»æ‰æ›è¡Œ
                    let txt = i.getAttribute('data-name');
                    if (!txt) {
                        txt = i.innerText.split('\n')[0]; // åªæŠ“ç¬¬ä¸€è¡Œæ–‡å­—ï¼Œå¿½ç•¥ small æ¨™ç±¤
                    }
                    activities.push(txt);
                });
                report += `ğŸ•’ ${timeLabel}: ${activities.join(' + ')}\n`;
            }
        });

        if (!hasItem) {
            report += "(å°šæœªå®‰æ’è¡Œç¨‹)\n";
        }
        
        report += `------------------\n`;
        report += `åœ°åœ–åƒè€ƒ: https://bit.ly/KH-Trip-Map`; // é€™è£¡åªæ˜¯ç¤ºæ„ï¼Œä¸éœ€è¦æ”¹

        // è¤‡è£½åˆ°å‰ªè²¼ç°¿
        navigator.clipboard.writeText(report).then(() => {
            alert(`âœ… è¤‡è£½æˆåŠŸï¼\n\nè«‹åˆ‡æ›åˆ° Line ç¾¤çµ„ï¼Œé•·æŒ‰å°è©±æ¡†è²¼ä¸Šå³å¯ã€‚`);
        }).catch(err => {
            console.error(err);
            alert("è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•æˆªåœ–ç•«é¢");
        });
    }
</script>

</body>
</html>
